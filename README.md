# PKU Grade Enhancement Script

![Version](https://img.shields.io/badge/version-7.0-blue)
![License](https://img.shields.io/badge/license-MIT-green)

这是一个用于美化北京大学成绩查询页面的 Tampermonkey (油猴) 脚本。它在恢复经典“红绿渐变”配色方案的同时，增加了强大的成绩模拟和可视化统计功能。

## 主要功能

### 1. 经典视觉体验
*   **红绿渐变配色**：恢复了经典的成绩着色方案，分数从 60 (红) 到 100 (绿) 平滑渐变，一目了然。
*   **极致彩虹特效**：**v7.0 全新升级！** 当单科成绩达到 **100分** 时，该行背景会显示动态流动的彩虹特效。采用了全新的渲染技术，确保流动效果丝滑、均匀、无缝，带来极致的视觉享受。
*   **着色模式切换**：支持在“百分制着色”（60-100渐变）和“四分制着色”（GPA 1.0-4.0渐变）之间一键切换。

### 2. 成绩模拟系统
*   **实时模拟**：点击顶部的 **“开启模拟”** 按钮，所有成绩数字变为可编辑输入框。
*   **全面支持**：不仅支持修改数字分数，还支持修改 **等级制成绩**（如 A, B, P, NP 等），满足各种模拟需求。
*   **动态计算**：修改任意课程分数，学期 GPA、累计 GPA 以及所有统计图表都会 **实时自动更新**。
*   **预测分析**：帮助你轻松预测“如果这门课考了90分，我的总绩点会变成多少”。

### 3. 可视化统计图表
*   **多维度分析**：提供四种统计图表（支持一键显示/隐藏）：
    *   **学期 GPA 走势**：展示每个学期的成绩起伏。
    *   **累计 GPA 走势**：展示从入学至今的绩点变化趋势。
    *   **学期修读学分**：展示每个学期的工作量。
    *   **分数段分布**：统计各分数段（<60, 60-70, ... 90-100）的课程数量。
*   **交互式图表**：图表数据会随模拟成绩的修改而实时变化。

### 4. 实用增强
*   **自动计算**：自动计算并显示每个学期的加权平均分和 GPA。
*   **页脚修复**：在页面底部补充官方 GPA 计算公式说明。

## 版本历史

### v7.0 (Current) - 视觉极致优化
*   **重构彩虹特效**：抛弃了传统的背景平铺方案，采用先进的 CSS 伪元素位移技术，彻底解决了动画流动时的“竖线”接缝和卡顿问题，实现了真正的无缝循环流动。
*   **优化模拟体验**：增强了对等级制成绩（Letter Grades）的模拟支持。

### v6.0 - 核心功能重构
*   **架构重写**：重构了脚本的核心逻辑，大幅提升性能和稳定性。
*   **新增图表**：引入了“累计 GPA”和“学期学分”图表，补全了数据分析维度。
*   **交互升级**：优化了模拟按钮样式，增加了显眼的交互效果；修复了图表时间轴顺序。

### v3.0 ~ v5.0 - 基础功能完善
*   逐步完善了经典的红绿配色逻辑。
*   实现了基础的 GPA 计算公式和简单的图表展示。

## 安装指南

本脚本需要配合 **Tampermonkey (油猴)** 浏览器扩展使用。如果你是第一次使用，请按照以下步骤操作：

### 第一步：安装 Tampermonkey 扩展
Tampermonkey 是一个脚本管理器，它允许你在浏览器中运行用户自定义的脚本。请根据你的浏览器点击下方链接进行安装：

*   **Chrome / Edge (推荐)**: [前往 Chrome 应用商店下载](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
*   **Firefox**: [前往 Firefox Add-ons 下载](https://addons.mozilla.org/zh-CN/firefox/addon/tampermonkey/)
*   **Safari**: [前往 Mac App Store 下载](https://apps.apple.com/cn/app/tampermonkey/id1482490089)

*安装完成后，你的浏览器右上角会出现一个黑色的图标（带有两个圆圈）。*

### 第二步：安装本脚本
1.  点击浏览器右上角的 **Tampermonkey 图标**。
2.  在弹出的菜单中选择 **“添加新脚本...” (Create a new script...)**。
3.  此时会打开一个代码编辑器页面，请**删除**里面原有的所有代码。
4.  打开本项目的 `pku_grades_enhanced.user.js` 文件，**复制**里面的全部代码。
5.  回到 Tampermonkey 编辑器，**粘贴**刚才复制的代码。
6.  按下快捷键 `Ctrl+S` (Windows) 或 `Cmd+S` (Mac) 保存脚本或者点击文件,点击保存即可。

### 第三步：开始使用
1.  访问北大成绩查询页面（支持 `treehole.pku.edu.cn` 或 `pkuhelper.pku.edu.cn`）。
2.  脚本会自动运行，你会在页面顶部看到新增的控制按钮（如“开启模拟”、“显示图表”等）。

## 使用说明

*   **切换颜色模式**：点击顶部栏的 `四分制着色 / 百分制着色` 按钮。
*   **查看图表**：点击顶部栏的 `显示图表` 按钮，图表区域将以动画形式在页面底部展开。
*   **模拟成绩**：
    1.  点击醒目的 `开启模拟` 按钮（红色/绿色渐变按钮）。
    2.  直接在表格中修改课程分数。
    3.  观察 GPA 和图表的实时变化。
    4.  再次点击按钮退出模拟，恢复真实成绩。

## 注意事项

*   **隐私安全**：本脚本所有计算和修改均在**本地浏览器**进行，**绝对不会**上传任何个人数据到服务器。
*   **仅供参考**：模拟模式下的成绩修改仅为视觉效果，刷新页面后即消失，不会修改教务系统中的真实成绩。
*   **兼容性**：脚本针对特定的页面结构（DIV布局）进行了优化，如果学校更新了教务系统页面结构，脚本可能需要更新。

## 许可证

本项目采用 [MIT License](LICENSE) 许可证。

---
*Created for PKUers, by PKUers.*
